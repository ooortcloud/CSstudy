## SQL 개념

### SQL이란 무엇인가?

Structured Query Language의 약자로, **관계형 데이터베이스**에서 데이터를 **조작하고 관리**하기 위해 사용되는 **표준화된 언어**입니다. 데이터베이스에 저장된 정보를 검색, 삽입, 수정, 삭제하는 등 다양한 작업을 수행할 수 있습니다.

### SQL과 프로그래밍 언어의 차이점

* **데이터 처리 방식:**

    * **SQL:** 데이터를 **테이블** 형태로 저장하고, 이 테이블을 대상으로 **쿼리**를 통해 데이터를 처리합니다. 즉, 데이터 자체보다는 **데이터 간의 관계**에 중점을 둡니다.
    * **C언어:** 데이터를 **변수**에 저장하고, 이 변수를 이용하여 **연산**을 수행합니다. 즉, 데이터를 **직접 조작**하는 데 초점을 맞춥니다.

* **문법:**

    * **SQL:** 비교적 간결하고 직관적인 문법으로 구성되어 있어, 데이터베이스에 대한 지식이 없더라도 쉽게 학습할 수 있습니다. 예를 들어, `SELECT * FROM users`는 'users' 테이블의 모든 데이터를 조회하는 쿼리입니다.
    * **C언어:** 다양한 자료형과 제어문, 함수 등을 사용하여 복잡한 프로그램을 구현할 수 있지만, 문법이 까다롭고 학습 곡선이 높습니다.

* **사용 환경:**

    * **SQL:** MySQL, PostgreSQL, Oracle 등 다양한 관계형 데이터베이스 시스템에서 사용됩니다.
    * **C언어:** 운영체제, 임베디드 시스템, 게임 개발 등 다양한 분야에서 사용됩니다.
    
**추가 학습 자료**

  * **W3Schools SQL Tutorial:** [https://www.w3schools.com/sql/](https://www.google.com/url?sa=E&source=gmail&q=https://www.w3schools.com/sql/)
  * **MySQL 공식 문서:** [https://dev.mysql.com/doc/](https://www.google.com/url?sa=E&source=gmail&q=https://dev.mysql.com/doc/)
  * **PostgreSQL 공식 문서:** [https://www.postgresql.org/docs/](https://www.google.com/url?sa=E&source=gmail&q=https://www.postgresql.org/docs/)

## SQL 동작 방식

### 1. SQL 실행 과정

#### 1.1. 파싱(Parsing)
* **SQL 문자열을 분석:** 데이터베이스 시스템은 입력된 SQL 문자열을 토큰(token) 단위로 분해하고, 문법적인 오류가 없는지 검사합니다.
* **parse tree 생성:** 문법 검사를 통과하면 파스 트리(parse tree)라는 트리 구조를 생성합니다. 파스 트리는 SQL 문장의 구조를 나타내는 일종의 청사진입니다.

#### 1.2. 최적화(Optimization)
* **실행 계획 생성:** 파스 트리를 기반으로 데이터베이스 시스템은 다양한 실행 계획(execution plan)을 생성합니다. 실행 계획은 쿼리를 실행하기 위한 최적의 방법을 나타냅니다. << 그러나 매번 정답에 가까운 실행 계획을 만들어내지는 못할 수 있다.
* **비용 기반 최적화:** 데이터베이스 시스템은 각 실행 계획의 비용(cost)을 계산하고, 가장 적은 비용이 드는 실행 계획을 선택합니다. 비용은 일반적으로 I/O 작업 횟수, CPU 사용량 등을 고려하여 산정됩니다.
* **인덱스 활용:** 데이터베이스 시스템은 인덱스를 활용하여 데이터 검색 속도를 향상시킬 수 있는 방법을 찾습니다. 적절한 인덱스가 생성되어 있다면, 데이터베이스 시스템은 인덱스를 이용하여 빠르게 데이터에 접근할 수 있습니다.

#### 1.3. 실행(Execution)
* **실행 계획 실행:** 선택된 실행 계획에 따라 데이터베이스 시스템은 실제로 데이터를 처리합니다.
* **결과 반환:** 처리된 결과를 사용자에게 반환합니다.

### 2. 예시

```sql
SELECT * FROM users WHERE age > 30;
```

위 쿼리가 실행되는 과정을 예시로 들어 설명하면 다음과 같습니다.

1. **파싱:** 데이터베이스 시스템은 `SELECT`, `FROM`, `WHERE` 등의 키워드를 인식하고, `users` 테이블에서 `age` 컬럼이 30보다 큰 모든 행을 조회하는 쿼리임을 파악합니다.
2. **최적화:** 데이터베이스 시스템은 `age` 컬럼에 인덱스가 생성되어 있다면 인덱스를 활용하여 빠르게 데이터를 검색하는 실행 계획을 선택할 수 있습니다. 만약 인덱스가 없다면 테이블 전체를 스캔하는 방법을 선택할 수 있습니다.
3. **실행:** 선택된 실행 계획에 따라 `users` 테이블을 검색하고, 조건에 맞는 행들을 추출하여 결과를 반환합니다.

### 3. 왜 SQL 실행 과정을 알아야 할까요?

* **쿼리 성능 최적화:** SQL 실행 과정을 이해하면 느린 쿼리를 분석하고, 인덱스를 적절하게 생성하여 쿼리 성능을 향상시킬 수 있습니다.
* **데이터베이스 설계:** 데이터베이스를 설계할 때, 테이블 구조, 인덱스 생성 등에 대한 결정을 내리는 데 도움이 됩니다.
* **데이터베이스 문제 해결:** 데이터베이스에서 발생하는 문제를 진단하고 해결하는 데 필요한 지식을 제공합니다.

### 4. 추가적으로 알아두면 좋은 것들

* **쿼리 옵티마이저:** 데이터베이스 시스템에서 실행 계획을 생성하는 모듈입니다.
* **실행 계획 캐시:** 이전에 실행된 쿼리의 실행 계획을 저장하여 동일한 쿼리가 다시 실행될 때 재사용합니다.
* **인덱스:** 특정 컬럼의 값을 빠르게 검색하기 위한 데이터 구조입니다.

## SQL 종류

### DML (Data Manipulation Language, 데이터 조작 언어)
* **데이터베이스 내 데이터를 조작하는 언어**입니다. 
* **주요 기능:**
    * **SELECT:** 데이터 조회
    * **INSERT:** 데이터 삽입
    * **UPDATE:** 데이터 수정
    * **DELETE:** 데이터 삭제
* **예시:**
    * `SELECT * FROM users;` (users 테이블의 모든 데이터 조회)
    * `INSERT INTO users (name, age) VALUES ('홍길동', 30);` (users 테이블에 새로운 데이터 삽입)

### DDL (Data Definition Language, 데이터 정의 언어)
* **데이터베이스의 구조를 정의하고 관리하는 언어**입니다.
* **주요 기능:**
    * **CREATE:** 테이블, 인덱스 등 데이터베이스 객체 생성
    * **ALTER:** 테이블 구조 변경 (컬럼 추가, 삭제, 수정 등)
    * **DROP:** 테이블, 인덱스 등 데이터베이스 객체 삭제
* **예시:**
    * `CREATE TABLE users (id INT PRIMARY KEY, name VARCHAR(50), age INT);` (users 테이블 생성)
    * `ALTER TABLE users ADD COLUMN email VARCHAR(100);` (users 테이블에 email 컬럼 추가)

### DCL (Data Control Language, 데이터 제어 언어)
* **데이터베이스에 대한 접근 권한을 관리하는 언어**입니다.
* **주요 기능:**
    * **GRANT:** 사용자에게 권한 부여
    * **REVOKE:** 사용자의 권한 회수
* **예시:**
    * `GRANT SELECT ON users TO user1;` (user1에게 users 테이블 조회 권한 부여)
    * `REVOKE ALL PRIVILEGES FROM user2;` (user2의 모든 권한 회수)

**간단히 정리하면:**

* **DML:** 데이터 자체를 다룬다 (조회, 삽입, 수정, 삭제)
* **DDL:** 데이터베이스의 구조를 다룬다 (테이블 생성, 변경, 삭제)
* **DCL:** 데이터베이스에 대한 접근 권한을 다룬다 (권한 부여, 회수)
